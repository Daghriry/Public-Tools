# محلل مساحة القرص الصلب - Disk Space Analyzer

أداة Python قوية لتحليل استخدام مساحة القرص الصلب وإنشاء تقارير Excel مفصلة مع رسومات بيانية وتحليل للملفات المكررة.

## 📋 جدول المحتويات
- [نظرة عامة](#نظرة-عامة)
- [المميزات](#المميزات)
- [المتطلبات](#المتطلبات)
- [التثبيت](#التثبيت)
- [طريقة الاستخدام](#طريقة-الاستخدام)
- [محتويات التقرير](#محتويات-التقرير)
- [شرح الألوان](#شرح-الألوان)
- [أمثلة على الاستخدام](#أمثلة-على-الاستخدام)
- [حل المشاكل](#حل-المشاكل)
- [الأسئلة الشائعة](#الأسئلة-الشائعة)

## 🔍 نظرة عامة

محلل مساحة القرص هو أداة تساعدك في:
- معرفة أين تذهب مساحة التخزين لديك
- اكتشاف الملفات والمجلدات الكبيرة
- إيجاد الملفات المكررة وحساب المساحة المهدرة
- تحليل أنواع الملفات وتوزيعها
- إنشاء تقارير Excel احترافية مع رسومات بيانية

## ✨ المميزات

### 1. **تحليل عميق وشامل**
- يفحص جميع المجلدات والملفات بشكل تكراري
- يحسب أحجام المجلدات بما في ذلك المحتويات المتداخلة
- يتعامل مع المسارات الطويلة في Windows (أكثر من 260 حرف)
- يتخطى الملفات المحمية أو التي لا يمكن الوصول إليها

### 2. **كشف الملفات المكررة**
- يستخدم MD5 hash لاكتشاف الملفات المتطابقة
- يحسب المساحة الإجمالية المهدرة
- يقترح أي ملفات يمكن حذفها مع الحفاظ على النسخة الأصلية
- يعرض تاريخ التعديل لكل ملف للمساعدة في اتخاذ القرار

### 3. **تقرير Excel متعدد الصفحات**
- **Summary**: ملخص شامل مع الإحصائيات الرئيسية
- **Charts**: رسومات بيانية تفاعلية (دائرية وأعمدة)
- **Folders**: تفاصيل جميع المجلدات
- **Files**: تفاصيل الملفات (حتى 10,000 ملف)
- **Duplicate Files**: الملفات المكررة مع المساحة المهدرة
- **File Types**: تحليل حسب أنواع الملفات
- **Large Files**: أكبر 100 ملف
- **Errors**: سجل بأي أخطاء تم مواجهتها

### 4. **رسومات بيانية احترافية**
- رسم دائري لتوزيع المساحة حسب أنواع الملفات
- رسم أعمدة لأكبر 10 مجلدات
- رسم دائري لتصنيف الملفات (مستندات، صور، فيديو، إلخ)

### 5. **واجهة سهلة الاستخدام**
- واجهة تفاعلية بالعربية والإنجليزية
- لا تحتاج لإدخال معاملات في سطر الأوامر
- حفظ تلقائي للتقرير بجانب السكربت
- عرض التقدم أثناء المسح

## 🔧 المتطلبات

### متطلبات النظام:
- Python 3.6 أو أحدث
- Windows / macOS / Linux

### المكتبات المطلوبة:
```bash
pandas
openpyxl
humanize
```

## 📥 التثبيت

### 1. تثبيت Python
تأكد من تثبيت Python 3.6 أو أحدث من [python.org](https://www.python.org/downloads/)

### 2. تثبيت المكتبات المطلوبة
افتح موجه الأوامر (Command Prompt) أو Terminal وقم بتشغيل:
```bash
pip install pandas openpyxl humanize
```

### 3. تحميل السكربت
احفظ ملف `disk_analyzer.py` في أي مجلد على جهازك

## 🚀 طريقة الاستخدام

### 1. تشغيل السكربت
افتح موجه الأوامر في مجلد السكربت وشغل:
```bash
python disk_analyzer.py
```

### 2. إدخال المسار
عند السؤال، أدخل المسار الذي تريد تحليله:
```
Enter the path to analyze (or 'quit' to exit): C:\Users\YourName\Documents
```

يمكنك إدخال:
- مسارات محلية: `C:\Users\YourName\Documents`
- مسارات الشبكة: `\\NetworkDrive\SharedFolder`
- Google Drive: `G:\My Drive`

### 3. انتظار التحليل
سيعرض السكربت:
- التقدم كل 5 ثوانٍ
- عدد الملفات والمجلدات التي تم فحصها
- الوقت المستغرق للتحليل

### 4. فتح التقرير
بعد الانتهاء، سيسألك إذا كنت تريد فتح التقرير مباشرة

## 📊 محتويات التقرير

### صفحة Summary (الملخص)
- تاريخ ووقت التحليل
- المسار الذي تم تحليله
- إجمالي عدد الملفات والمجلدات
- الحجم الإجمالي ومتوسط حجم الملف
- عدد مجموعات الملفات المكررة
- أكبر 10 مجلدات مع ألوان حسب الحجم

### صفحة Charts (الرسومات البيانية)
#### 1. رسم دائري - توزيع المساحة حسب نوع الملف
- يعرض أكثر 10 أنواع ملفات استهلاكاً للمساحة
- النسبة المئوية لكل نوع

#### 2. رسم أعمدة - أكبر 10 مجلدات
- المجلدات مرتبة حسب الحجم
- الحجم بالجيجابايت

#### 3. رسم دائري - التصنيف حسب الفئات
- المستندات (doc, pdf, txt)
- الصور (jpg, png, gif)
- الفيديوهات (mp4, avi, mkv)
- الصوتيات (mp3, wav, flac)
- الملفات المضغوطة (zip, rar, 7z)
- الأكواد البرمجية (py, js, java)
- أخرى

### صفحة Folders (المجلدات)
- المسار الكامل لكل مجلد
- الحجم بالبايت والصيغة المقروءة
- عدد الملفات والمجلدات الفرعية
- عمق المجلد في التسلسل الهرمي
- فلاتر وترتيب للبيانات

### صفحة Files (الملفات)
- تفاصيل حتى 10,000 ملف
- الاسم والامتداد والحجم
- تاريخ التعديل والإنشاء
- المجلد الأصل
- ألوان حسب حجم الملف

### صفحة Duplicate Files (الملفات المكررة)
- المجموعات المكررة مرتبة حسب الحجم
- إجمالي المساحة المهدرة
- اقتراحات بالملفات التي يمكن حذفها
- تاريخ التعديل لكل ملف
- ألوان متناوبة للمجموعات

### صفحة File Types (أنواع الملفات)
- جميع الامتدادات الموجودة
- عدد الملفات من كل نوع
- الحجم الإجمالي والمتوسط
- مرتبة حسب الحجم الإجمالي

### صفحة Large Files (أكبر الملفات)
- أكبر 100 ملف في المسار
- الترتيب والاسم والحجم
- الامتداد والمسار الكامل
- ألوان حسب الحجم

### صفحة Errors (الأخطاء)
- قائمة بأي أخطاء تم مواجهتها
- الملفات التي لم يمكن الوصول إليها
- المجلدات المحمية

## 🎨 شرح الألوان

الملفات والمجلدات ملونة حسب الحجم:
- 🔴 **أحمر**: أكبر من أو يساوي 1 جيجابايت
- 🟠 **برتقالي**: أكبر من أو يساوي 500 ميجابايت
- 🟡 **أصفر**: أكبر من أو يساوي 100 ميجابايت
- 🟢 **أخضر فاتح**: أكبر من أو يساوي 10 ميجابايت
- 🔵 **أزرق فاتح**: أقل من 10 ميجابايت

## 💡 أمثلة على الاستخدام

### مثال 1: تحليل مجلد المستندات
```
Enter the path to analyze: C:\Users\Ahmed\Documents

Analyzing: C:\Users\Ahmed\Documents
Report will be saved to: C:\Scripts\disk_analysis_Documents_20240806_143025.xlsx

This may take several minutes depending on the number of files...
Starting analysis of: C:\Users\Ahmed\Documents
Scanning files and folders...
Progress: 5,234 files, 432 folders scanned...

Analysis completed in 45.23 seconds
Found 8,543 files and 654 folders
```

### مثال 2: تحليل Google Drive
```
Enter the path to analyze: G:\My Drive

Analyzing: G:\My Drive
Report will be saved to: C:\Scripts\disk_analysis_My_Drive_20240806_150000.xlsx
```

## 🔧 حل المشاكل

### مشكلة: "ModuleNotFoundError"
**الحل**: تأكد من تثبيت المكتبات المطلوبة
```bash
pip install pandas openpyxl humanize
```

### مشكلة: مسارات طويلة في Windows
**الحل**: السكربت يتعامل تلقائياً مع المسارات الطويلة باستخدام `\\?\`

### مشكلة: "Permission denied"
**الحل**: 
- شغل السكربت كمسؤول (Run as Administrator)
- أو تجاهل هذه الملفات (ستظهر في صفحة الأخطاء)

### مشكلة: السكربت بطيء جداً
**الأسباب المحتملة**:
- عدد كبير جداً من الملفات
- قرص صلب بطيء
- ملفات على الشبكة

**الحلول**:
- حلل مجلدات أصغر
- أغلق البرامج الأخرى
- استخدم SSD إن أمكن

## ❓ الأسئلة الشائعة

### س: هل يمكن تحليل أقراص الشبكة؟
ج: نعم، يمكن تحليل أي مسار يمكن الوصول إليه من النظام

### س: ما هو الحد الأقصى لعدد الملفات؟
ج: لا يوجد حد نظري، لكن التقرير يعرض أول 10,000 ملف فقط للأداء

### س: هل السكربت آمن؟
ج: نعم، السكربت يقرأ فقط ولا يعدل أو يحذف أي ملفات

### س: لماذا بعض الملفات لا تظهر كمكررة؟
ج: السكربت يفحص فقط الملفات الأصغر من 100 ميجابايت للأداء

### س: هل يمكن تخصيص التقرير؟
ج: نعم، يمكن تعديل الكود لإضافة المزيد من التحليلات أو تغيير الحدود

## 📝 ملاحظات إضافية

- التقرير يُحفظ تلقائياً بجانب السكربت
- اسم الملف يتضمن اسم المجلد والتاريخ والوقت
- يمكن فتح التقرير بأي برنامج يدعم Excel
- الفلاتر متاحة في جميع صفحات البيانات
- يمكن طباعة أي صفحة من التقرير

## 🤝 المساهمة

لتحسين الأداة أو إضافة مميزات جديدة، يمكنك:
1. تعديل الكود حسب احتياجاتك
2. إضافة أنواع تحليلات جديدة
3. تحسين الأداء للملفات الكبيرة
4. إضافة دعم لصيغ تقارير أخرى

---

**تم تطوير هذه الأداة لمساعدتك في إدارة مساحة التخزين بكفاءة** 💾